

#ifndef SYSTEM_DRIVERS_I2C_TCA8418_TCA8418_H_
#define SYSTEM_DRIVERS_I2C_TCA8418_TCA8418_H_

#define KEYPAD 0x37
#define GPIO 0x38
#define EDGE 0x39
#define LEVEL 0x40
#define INTERRUPT 0x41
#define NOINTERRUPT 0x42
#define FIFO 0x43
#define NOFIFO 0x44
#define DEBOUNCE 0x45
#define NODEBOUNCE 0x46


/* TCA8418 register offsets */
#define TCA8418_REG_CFG 0x01
#define TCA8418_REG_INT_STAT 0x02
#define TCA8418_REG_KEY_LCK_EC 0x03
#define TCA8418_REG_KEY_EVENT_A 0x04
#define TCA8418_REG_KEY_EVENT_B 0x05
#define TCA8418_REG_KEY_EVENT_C 0x06
#define TCA8418_REG_KEY_EVENT_D 0x07
#define TCA8418_REG_KEY_EVENT_E 0x08
#define TCA8418_REG_KEY_EVENT_F 0x09
#define TCA8418_REG_KEY_EVENT_G 0x0A
#define TCA8418_REG_KEY_EVENT_H 0x0B
#define TCA8418_REG_KEY_EVENT_I 0x0C
#define TCA8418_REG_KEY_EVENT_J 0x0D
#define TCA8418_REG_KP_LCK_TIMER 0x0E
#define TCA8418_REG_UNLOCK1 0x0F
#define TCA8418_REG_UNLOCK2 0x10
#define TCA8418_REG_GPIO_INT_STAT1 0x11
#define TCA8418_REG_GPIO_INT_STAT2 0x12
#define TCA8418_REG_GPIO_INT_STAT3 0x13
#define TCA8418_REG_GPIO_DAT_STAT1 0x14
#define TCA8418_REG_GPIO_DAT_STAT2 0x15
#define TCA8418_REG_GPIO_DAT_STAT3 0x16
#define TCA8418_REG_GPIO_DAT_OUT1 0x17
#define TCA8418_REG_GPIO_DAT_OUT2 0x18
#define TCA8418_REG_GPIO_DAT_OUT3 0x19
#define TCA8418_REG_GPIO_INT_EN1 0x1A
#define TCA8418_REG_GPIO_INT_EN2 0x1B
#define TCA8418_REG_GPIO_INT_EN3 0x1C
#define TCA8418_REG_KP_GPIO1 0x1D
#define TCA8418_REG_KP_GPIO2 0x1E
#define TCA8418_REG_KP_GPIO3 0x1F
#define TCA8418_REG_GPI_EM1 0x20
#define TCA8418_REG_GPI_EM2 0x21
#define TCA8418_REG_GPI_EM3 0x22
#define TCA8418_REG_GPIO_DIR1 0x23
#define TCA8418_REG_GPIO_DIR2 0x24
#define TCA8418_REG_GPIO_DIR3 0x25
#define TCA8418_REG_GPIO_INT_LVL1 0x26
#define TCA8418_REG_GPIO_INT_LVL2 0x27
#define TCA8418_REG_GPIO_INT_LVL3 0x28
#define TCA8418_REG_DEBOUNCE_DIS1 0x29
#define TCA8418_REG_DEBOUNCE_DIS2 0x2A
#define TCA8418_REG_DEBOUNCE_DIS3 0x2B
#define TCA8418_REG_GPIO_PULL1 0x2C
#define TCA8418_REG_GPIO_PULL2 0x2D
#define TCA8418_REG_GPIO_PULL3 0x2E

/* TCA8418 bit definitions */
#define TCA8418_CFG_AI 0x80
#define TCA8418_CFG_GPI_E_CFG 0x40
#define TCA8418_CFG_OVR_FLOW_M 0x20
#define TCA8418_CFG_INT_CFG 0x10
#define TCA8418_CFG_OVR_FLOW_IEN 0x08
#define TCA8418_CFG_K_LCK_IEN 0x04
#define TCA8418_CFG_GPI_IEN 0x02
#define TCA8418_CFG_KE_IEN 0x01

#define TCA8418_INT_STAT_CAD_INT 0x10
#define TCA8418_INT_STAT_OVR_FLOW_INT 0x08
#define TCA8418_INT_STAT_K_LCK_INT 0x04
#define TCA8418_INT_STAT_GPI_INT 0x02
#define TCA8418_INT_STAT_K_INT 0x01

/* TCA8418 register masks */
#define TCA8418_KEY_LCK_EC_KEC 0x7
#define TCA8418_KEY_EVENT_CODE 0x7f
#define TCA8418_KEY_EVENT_VALUE 0x80

/* TCA8418 Rows and Columns */
#define ROW0 0x01
#define ROW1 0x02
#define ROW2 0x04
#define ROW3 0x08
#define ROW4 0x10
#define ROW5 0x20
#define ROW6 0x40
#define ROW7 0x80

#define COL0 0x0001
#define COL1 0x0002
#define COL2 0x0004
#define COL3 0x0008
#define COL4 0x0010
#define COL5 0x0020
#define COL6 0x0040
#define COL7 0x0080
#define COL8 0x0100
#define COL9 0x0200


void TCA8418_Init();

uint8_t TCA8418_GetKeyEventCount();

uint8_t TCA8418_ReadKeyEvent();

#endif
